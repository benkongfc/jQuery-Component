<h2>Chinese Study</h2>
<div jqcIf="page == 'list'">
    <div jqcEach="cdata">
        <button jqcOn="click: {fire: 'read(index)'}">Read</button> &nbsp;
        <span jqcEach="chars" class="char"><font jqcText="char"></font></span> &nbsp;
        <button jqcOn="click: {fire: 'learn(index)'}">Learn</button> &nbsp;
        <button jqcOn="click: {fire: 'test(index)'}">Test</button> &nbsp;
    </div>
</div>
<div jqcIf="page == 'learn'">
    <div class="lChar text-center" jqcText="lChar"></div>
    <div class="lAllChars text-center"><span jqcEach="cdata[learnIndex]"><font jqcText="char"></font></span></div>
</div>
<div jqcIf="page == 'test'">
    
</div>
<style>
    .char {
        font-size: 2em;
    }
    .lChar {
        font-size: 4em;
    }
    .lAllChars {
        font-size: 3em;
    }
</style>

<script>
    (function($){
        $.ajax({
            data: {},
            type: "GET",
            url: "assets/data/dataChinese.txt?"+Math.random(),
            success: function(d){
                var data = d.split("\n");
                console.log(data);
                var data1 = [];
                $.each(data, function(i, v){
                    var row = [];
                    var j = 0;
                    for (var c of v) {
                        row.push({index: j, char: c});
                        j++;
                    }
                    data1.push({index: i, chars: row});
                });
                m.cdata = data1;
                if(m.update)
                    m.update();
            }
        });
        function getRandomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }
        var m = {
            page: 'list',
            learnIndex: 0,
            lChar: '',
            cdata: [],
            read: function(index){
                new Audio('assets/data/mp3/c'+(index+1)+'.m4a').play();
            },
            learn: function(index){
                this.page = 'learn';
                this.learnIndex = index;
                do{
                    this.lChar = this.cdata[index].chars[getRandomInt(0, 15)].char;
                }while(!this.lChar.trim());
            }
        };
        return m;
    })(jQuery);
</script>